<!DOCTYPE html>
<html>
  <head>
    <title>Edit</title>
    <link rel="stylesheet" href="style/main.css" type="text/css">
  </head>
  <body>
    <div id="account"></div>

    <h1>Foodcart Pages</h1>

    <div id="profile"></div>
    <div id="items">
      <h3>Edit a Foodcart</h3>
      <form id="itemform">
        <fieldset>
          <legend>Basics</legend>
          Name: <input type="text" id="name"/> <br/>
          Description: <textarea id="description" cols="40" rows="8"></textarea>
        </fieldset>
        <input type="submit" />
      </form>
    </div>

    <div id="sidebar">
      <p>Find information about foodcarts.</p>
      <p>Ideas: You could easily turn this into a photo sharing app, or a grocery list, or a chat room.</p>
    </div>
  </body>
  <script src="vendor/couchapp/loader.js"></script>
  <script type="text/javascript" charset="utf-8">
    $.couch.app(function(app) {
      $("#account").evently("account", app);
      $("#profile").evently("profile", app);
      $.evently.connect("#account","#profile", ["loggedIn","loggedOut"]);
      var uDoc;
      app.db.openDoc(jQuery.url.param("id"), { success : function(userDoc) { 
                                                           uDoc = userDoc;
                                                           $('#name').val(userDoc.name);
                                                           $('#description').val(userDoc.description);
                                              }});
      $('#itemform').submit(function(event) {
                             uDoc.name = $('#name').val();
                             uDoc.description = $('#description').val();
                             app.db.saveDoc(uDoc, {
                                    success : function() {
                                      window.location = "show.html?id="+uDoc._id;
                                    }
                            });
                            return false;
                    });
    });
  </script>
</html>
